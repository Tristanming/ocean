<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=640,target-densitydpi=device-dpi, user-scalable=no">
<title>O2BEST | HYDRON</title>
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<meta name="format-detection"content="telephone=no, email=no" />
<link rel="stylesheet" type="text/css" href="css/normalize.css" />
<link rel="stylesheet" type="text/css" href="css/main.css?v=1" />
<link rel="stylesheet" href="css/swiper.css">
<script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
</head>

<body>
  <div class="audio" style="display:none;">
  	<audio id="soundSp" src="audio/slash.mp3" preload="auto"></audio>
  	<!--<audio id="soundBg" src="audio/bg.mp3" preload="auto"></audio>-->
  </div>
  <div class="page-content">
    <!-- loading -->
  	<div class="loading" style="opacity: 1; display: none;">
		<div class="loading-icon" style="display: block;">
			<div class="mask">
				<div class="mask-rotate" style="transform: rotate(-180deg);"></div>
			</div>
			<div class="mask">
				<div class="mask-rotate" style="transform: rotate(-180deg);"></div>
			</div>
			<div class="mask">
				<div class="mask-rotate" style="transform: rotate(-180deg);"></div>
			</div>
			<div class="mask">
				<div class="mask-rotate" style="transform: rotate(-180deg);"></div>
			</div>
		</div>
	</div>

    <div class="swiper-container">
      <div class="swiper-wrapper">

        <div class="swiper-slide slide-1" data-hash="slide-1">
          <div class="tips_arrow"><img src="images/arrow.png"></div>
          <div class="bg"></div>
          <div class="scale_control">
            <div class="bubble1"></div>
            <div class="prd1"></div>
            <div class="bubbles">
              <div class="bubble_samll1"></div>
              <div class="bubble_samll2"></div>
              <div class="bubble_samll3"></div>
              <div class="bubble_samll4"></div>
              <div class="bubble_samll5"></div>
            </div>
            <div class="txt1">
              <p><span>海</span><span>昌</span><span><img src="images/o_txt1_img1.png"></span><span>睛</span><span>透</span><span>氧</span></p>
              <p><span>硅</span><span>水</span><span>凝</span><span>胶</span><span>隐</span><span>形</span><span>眼</span><span>镜</span></p>
            </div>
            <div class="txt2">
              <span><img src="images/o_txt2_img1.png"><div class="shine1"></div></span>
              <span><img src="images/o_txt2_img2.png"><div class="shine2"></div></span>
              <span><img src="images/o_txt2_img3.png"><div class="shine3"></div></span>
              <span><img src="images/o_txt2_img4.png"><div class="shine4"></div></span>
            </div>
          </div>
        </div>

        <div class="swiper-slide slide-2" data-hash="slide-2" data-bottom-hl="1">
          <div class="tips_arrow"><img src="images/arrow.png"></div>
          <div class="bg"></div>
          <div class="scale_control">
            <div class="ttl"><img src="images/o_slide2_ttl1.png"></div>
            <div class="adv"><img src="images/o_slide2_img1.png"></div>
            <div class="leftcol">
              <span class="text1"><img src="images/o_slide2_img2-1.png"></span>
              <div class="number1">
                <div class="time time1">
                  <div class="digit"><div class="bg1"></div></div>
                </div>
                <div class="time time2">
                  <div class="digit"><div class="bg1"></div></div>
                </div>
              </div>
              <div class="square1"></div>
              <span class="text2"><img src="images/o_slide2_img4.png"></span>
            </div>
            <div class="rightcol">
              <span class="text1"><img src="images/o_slide2_img2-1.png"></span>
              <span class="crown"><img src="images/o_slide2_img6.png"></span>
              <div class="number2">
                <div class="time time1">
                    <div class="digit"><div class="bg1"></div></div>
                  </div>
                  <div class="time time2">
                    <div class="digit"><div class="bg1"></div></div>
                  </div>
                  <div class="time time3">
                    <div class="digit"><div class="bg1"></div></div>
                  </div>
                  <div class="time time4">
                    <div class="digit"><div class="bg1"></div></div>
                  </div>
                  <div class="dot"></div>
              </div>
              <div class="square2"></div>
              <span class="text2"><img src="images/o_slide2_img8.png"></span>
            </div>
          </div>
        </div>
        
        <div class="swiper-slide slide-3" data-hash="slide-3" data-bottom-hl="1">
          <div class="tips_arrow"><img src="images/arrow.png"></div>
          <div class="bg"></div>
          <div class="scale_control">
            <div class="ttl1"><img src="images/o_slide3_ttl1.png"></div>
            <div class="clock">
              <span class="mid2"></span>
              <span class="mid"></span>
              <span class="move1"></span>
              <span class="move2"></span>
            </div>
            <div class="twelve"><img src="images/o_slide3_twelve.png"><span class="cross"><img src="images/o_slide3_cross.png"></span></div>
          </div>
        </div>
        
        <div class="swiper-slide slide-4" data-hash="slide-4" data-bottom-hl="1">
          <div class="tips_arrow"><img src="images/arrow.png"></div>
          <div class="bg"></div>
          <div class="scale_control">
            <div class="ttl1"><img src="images/o_slide4_ttl1.png"></div>
            <div class="ttl2"><img src="images/o_slide4_ttl2.png"></div>
            <div class="moon_wrap">
              <div class="moon"></div>
              <div class="zzz">
                <span class="z1"><img src="images/o_slide4_z1.png"></span>
                <span class="z2"><img src="images/o_slide4_z2.png"></span>
                <span class="z3"><img src="images/o_slide4_z3.png"></span>
              </div>
            </div>
          </div>
        </div>
        
        <div class="swiper-slide slide-5" data-hash="slide-5" data-bottom-hl="2">
          <div class="bg"></div>
          <div class="scale_control">
            <div class="ttl1"><img src="images/o_slide5_ttl1.png"></div>
            <div class="water_wrap">
              <div class="text">
                <div class="water_num">
                  <!--<img src="images/o_slide5_waternum.png"><img src="images/o_slide5_waternum.png">-->
                  <div class="time time1">
                    <div class="digit"><div class="bg1"></div></div>
                  </div>
                  <div class="time time2">
                    <div class="digit"><div class="bg1"></div></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="scale-container">
                <div class="scale-content">
                    <div class="waters">
                        <!--<div class="water water-1 high-water"></div>
                        <div class="water water-2 high-water reverse-water"></div>-->
                        <div class="water water-3 low-water"></div>
                        <div class="water water-4 low-water reverse-water"></div>
                    </div>
                </div>
            </div>
          </div>
        </div>
        
        <div class="swiper-slide slide-6" data-hash="slide-6" data-bottom-hl="3">
          <div class="bg"></div>
          <div class="scale_control">
            <div class="ttl1"><img src="images/o_slide6_ttl1.png"></div>
            <div class="eye_wrap2">
              <div class="eye_wrap">
                <div class="eye"><img src="images/o_slide6_eye.png"></div>
                <div class="glass"><img src="images/o_slide6_glass.png"></div>
              </div>
              <div class="shadow"></div>
            </div>
            <div class="arrow"><img src="images/o_slide6_arrow.png"></div>
            <span class="text"><img src="images/o_slide6_text.png"></span>
          </div>
        </div>
        
        <div class="swiper-slide slide-7" data-hash="slide-7" data-bottom-hl="4">
          <div class="bg"></div>
          <!--<div class="scale_control">-->
            <div class="ttl1"><img src="images/o_slide7_ttl1.png"></div>
            <div class="txt1"><img src="images/o_slide7_txt1.png"></div>
            <div class="txt2"><img src="images/o_slide7_txt2.png"></div>
            <div class="circle_wrap">
              <div class="glass"><img src="images/o_slide7_glass2.png"></div>
              <img class="circle" src="images/o_slide7_circle.png">
            </div>
          <!--</div>-->
        </div>
        
        <div class="swiper-slide slide-8" data-hash="slide-8">
          <div class="s_container"><img src="images/o_slide6_img1.jpg"></div>
        </div>
        
      </div>
    </div>
    
    <div class="hud">
      <div class="logo"></div>
    </div>
    <div class="bottom">
      <div class="icons flex flex-pack-center">
        <div class="icon1 flex-1" data-slide-to=".slide-2"><span class="on"></span></div>
        <div class="icon2 flex-1" data-slide-to=".slide-5"><span></span></div>
        <div class="icon3 flex-1" data-slide-to=".slide-6"><span></span></div>
        <div class="icon4 flex-1" data-slide-to=".slide-7"><span></span></div>
      </div>
    </div>
    
  </div>
  <!-- .page-content -->

<script src="js/jquery-2.1.3.js"></script>
<script src="js/gsap/TweenMax.js"></script>
<script src="js/swiper.jquery.js"></script>
<script type="text/javascript">
window.addEventListener('load', function(){
   setTimeout(function(){ window.scrollTo(0, 1); }, 100);
});

$(document).ready(function(){

  //page preloading
  var imgList = 'arrow.png,loading-bg.jpg,loading-outline.png,o-btm-icon1-off.png,o-btm-icon1.png,o-btm-icon2-off.png,o-btm-icon2.png,o-btm-icon3-off.png,o-btm-icon3.png,o-btm-icon4-off.png,o-btm-icon4.png,o_bubble_small1.png,o_bubble_small2.png,o_bubble_small3.png,o_bubble_small4.png,o_bubble_small5.png,o_logo.png,o_slide1_bg1.jpg,o_slide1_bubble1.png,o_slide1_prd1.png,o_slide2_bg.jpg,o_slide2_img1.png,o_slide2_img2-1.png,o_slide2_img3.png,o_slide2_img4.png,o_slide2_img6.png,o_slide2_img7.png,o_slide2_img8.png,o_slide2_ttl1.png,o_slide3_clock.png,o_slide3_cross.png,o_slide3_mid.png,o_slide3_mid2.png,o_slide3_move1.png,o_slide3_move2.png,o_slide3_ttl1.png,o_slide3_twelve.png,o_slide4_moon.png,o_slide4_ttl1.png,o_slide4_ttl2.png,o_slide4_z1.png,o_slide4_z2.png,o_slide4_z3.png,o_slide5_text.png,o_slide5_ttl1.png,o_slide5_water.png,o_slide5_waternum.png,o_slide6_arrow.png,o_slide6_eye.png,o_slide6_glass.png,o_slide6_img1.jpg,o_slide6_shadow.png,o_slide6_text.png,o_slide6_ttl1.png,o_slide7_bg.jpg,o_slide7_circle.png,o_slide7_glass.png,o_slide7_glass2.png,o_slide7_ttl1.png,o_slide7_txt1.png,o_slide7_txt2.png,o_txt1_img1.png,o_txt2_img1.png,o_txt2_img2.png,o_txt2_img3.png,o_txt2_img4.png,o_slide2_floatnum.png,o_slide2_dot.png,o_slide2_floatnum2.png,shine.png,shine1.png,wave.png,wave0.png,wx-share.jpg,wx-share-new.jpg';
  imgList = imgList.match(/[^,]+/g);
  //console.debug(imgList);
  //show loading page when bg pic loaded
  $('<img src="./images/loading-outline.png">').load(function(e) {
        $('.loading').show();
		$('.loading-icon').show();

		var imgProgress = 0;
		var timeProgress = 0;
		function updateProgress() {
			var progress = Math.min(imgProgress, timeProgress);
			$('.loading-icon .mask-rotate').each(function(i, elem) {
				var angle = 360 * progress;
				var maskAngle = angle-180+ 90 * i;
				maskAngle = Math.max(maskAngle, 0);
				maskAngle = Math.min(maskAngle, 180);
				$(this).css({transform: 'rotate('+maskAngle+'deg)'});
			});
			if (progress == 1) {
			    //alert('load completed!');
				progress1();
				var swiper = $('.swiper-container').data('swiper');
				swiper.slideTo(0, 0);
				new TimelineLite({onComplete: function() {
					if (swiper.activeIndex != 0) {
						swiper.slideTo(0, 0);
					}
					else {
						var slide = swiper.slides[swiper.activeIndex];
						var tl = $(slide).data('tl');
						tl && tl.play(0);
					}
				}}).to('.loading', 1, {opacity: 0})
					.set('.loading', {display: 'none'})
					.set('.swiper-container', {display: 'block'})
					.to('.swiper-container', 1, {opacity: 1}, 0)
					.timeScale(3)
					;
			}
		}
		var loadedCount = 0;
		$.each(imgList, function(i, item) {
			$('<img>').prop({src: './images/' + item}).on('load error', function(e) {
				loadedCount++;
				imgProgress = loadedCount/imgList.length
				updateProgress();
			});
		});
		$({p:0}).animate({p:1}, {duration: 3200, progress: function(animation, progress, remainingMs) {
			timeProgress = this.p;
			updateProgress();
		}});
	});
	
	$('[data-slide-to]').click(function(e) {
	  var selector = $(this).data('slide-to');
	  var $container = $('.swiper-container');
	  var swiper = $container.data('swiper');
	  var index = $(selector).index();
	  try {
		  swiper.slideTo(index);
	  } catch (e) {
		  console.error(e);
	  }
	});

	
	
  //初始化函数
  function init(){
    $('#soundSp')[0].pause();
    //$('#soundBg')[0].loop = true;
    //$('#soundBg')[0].play();
    
	//创建每一页动画对象
	$('.swiper-slide').each(function (i, elem) {
	  var tl = new TimelineLite({ paused: true });
	  var $slide = $(this);
	  $slide.data().tl = tl;
	});
	
	//预定义第一页动画
	$('.slide-1').each(function(i,elem){
	  var $slide = $(this);	  
	  var tl = $slide.data().tl;
	  tl
	    .to($slide.find('.tips_arrow'), 0.6, {y: -10, yoyo: true, repeat: -1, ease: Sine.easeInOut})
		.to($slide.find('.bubble1'), 0.8, {top: 85, opacity: 1,ease: Sine.easeInOut}, 0.2)
		.to($slide.find('.bubble1'), 1, {y: -15, yoyo: true, repeat: -1, ease: Sine.easeInOut}, 1.2)
		.from($slide.find('.bubbles'), 1, { top: -100, opacity: 0 }, 1)
		.from($slide.find('.bubble_samll1'), 1, { top: 50, opacity: 0}, 1.8)
		.from($slide.find('.bubble_samll5'), 1.5, { top: 250, opacity: 0}, 2)
		.to($slide.find('.bubble_samll1'), 0.6, {y: -5, yoyo: true, repeat: -1, ease: Sine.easeInOut}, 0)
		.to($slide.find('.bubble_samll2'), 1.5, {y: -5, yoyo: true, repeat: -1, ease: Sine.easeInOut}, 0)
		.to($slide.find('.bubble_samll3'), 0.4, {y: -5, yoyo: true, repeat: -1, ease: Sine.easeInOut}, 0)
		.to($slide.find('.bubble_samll4'), 0.8, {y: -5, yoyo: true, repeat: -1, ease: Sine.easeInOut}, 0)
		.to($slide.find('.bubble_samll5'), 0.9, {y: -5, yoyo: true, repeat: -1, ease: Sine.easeInOut}, 0)
		.staggerFrom($slide.find('.txt1 span'), .3, { opacity: 0, x: -5}, 0.05, 2.5)
		.staggerFrom($slide.find('.txt2 span'), .3, { opacity: 0, x: -20}, 0.3, 2.5)
		.from($slide.find('.prd1'), 1, { left: 60, opacity: 0 },2.5)
		.to($slide.find('.shine1'), .5, {css:{backgroundPosition: "100px 0px"}, ease: Sine.easeInOut}, 4.8)
		.to($slide.find('.shine2'), .5, {css:{backgroundPosition: "100px 0px"}, ease: Sine.easeInOut}, 5.0)
		.to($slide.find('.shine3'), .5, {css:{backgroundPosition: "100px 0px"}, ease: Sine.easeInOut}, 5.2)
		.to($slide.find('.shine4'), .5, {css:{backgroundPosition: "100px 0px"}, ease: Sine.easeInOut}, 5.4)
	  ;
	});
	
	//预定义第二页动画
	$('.slide-2').each(function (i, elem) {
		var $slide = $(this);
		var tl = $slide.data().tl;
		
		tl
		  .to($slide.find('.tips_arrow'), 0.6, {y: -10, yoyo: true, repeat: -1, ease: Sine.easeInOut}, 0)
		  .to($slide.find('.square1'), 0.5, { height: 50, ease: Linear.easeIn, }, 1)
		  .to($slide.find('.number1'), 0.5, { bottom: 145 }, 1)
		  .to($slide.find('.number1 .time1 .digit'), 0.7, {top:-120, ease: Sine.easeIn}, .8)
		  .to($slide.find('.number1 .time2 .digit'), 0.7, {top:-240, ease: Sine.easeIn}, .8)
		  .to($slide.find('.leftcol .text1'), 0.9, { bottom: 195 }, 1)
		  .to($slide.find('.square2'), 1, { height: 360,ease: Linear.easeIn, }, 1)
		  .to($slide.find('.number2'), 1, { bottom: 445 }, 1)
		  .to($slide.find('.number2 .time1 .digit'), 1, {top:-70, ease: Sine.easeIn}, 1)
		  .to($slide.find('.number2 .time2 .digit'), 1.2, {top:-1260, ease: Sine.easeIn}, 1)
		  .to($slide.find('.number2 .time3 .digit'), 1.4, {top:-1890, ease: Sine.easeIn}, 1)
		  .to($slide.find('.number2 .time4 .digit'), 1.6, {top:-1050, ease: Sine.easeIn}, 1)
		  
		  .to($slide.find('.rightcol .text1'), 1.5, { bottom: 594 }, 1)
		  .from($slide.find('.rightcol .crown'), 1, { opacity: 0, scale: 2 }, 2.5)
		  .from($slide.find('.adv'), 0.5, { opacity: 0, scale: 1.5, ease: Sine.easeInOut }, 3.5)
		;
	});
	
	//预定义第三页动画
	$('.slide-3').each(function (i, elem) {
		var $slide = $(this);
		var tl = $slide.data().tl;
		tl
		  .to($slide.find('.tips_arrow'), 0.6, {y: -10, yoyo: true, repeat: -1, ease: Sine.easeInOut}, 0)
		  .from($slide.find('.clock'), 0.5, { opacity: 0,top: 258 }, 0.3)
		  .to($slide.find('.move1'), 50, { rotation:36000,transformOrigin: "left center",ease: Linear.easeIn,repeat: -1}, 1.2)
		  .to($slide.find('.move2'), 50, { rotation:3600,transformOrigin: "left center",ease: Linear.easeIn,repeat: -1 }, 1.2)
		  .from($slide.find('.twelve'), 1, { opacity: 0,left:417 }, 2)
		  .from($slide.find('.cross'), 0.5, { scale:1.5,opacity: 0, }, 3)
		  .to($slide.find('.cross'), 1, { rotation:360,transformOrigin: "center center",repeat: -1,repeatDelay:1.5 }, 4)
		;
	});
	
	//预定义第四页动画
	$('.slide-4').each(function (i, elem) {
		var $slide = $(this);
		var tl = $slide.data().tl;
		
		tl
		  .from($slide.find('.moon'), 0.6, { scale: 0 }, 0.2)
		  /*.staggerTo($slide.find('.zzz span'), 1.5, { opacity:1,repeat: -1 }, 0.3, 1.5)*/
		  
		;
		
		var tlRepeat = new TimelineMax();
		tlRepeat
		  .repeat(-1)
          .to($slide.find('.zzz .z1'), 0.5, { opacity:1 }, .7)
          .to($slide.find('.zzz .z2'), 0.5, { opacity:1 } )
          .to($slide.find('.zzz .z3'), 0.5, { opacity:1 } )
          .to($slide.find('.zzz span'), 0.1, { opacity:0 } )
		;
		tl.add(tlRepeat);

	});
	
	//预定义第五页动画
	$('.slide-5').each(function (i, elem) {
		var $slide = $(this);
		var tl = $slide.data().tl;
		var $water = $slide.find('.water');
		var $defaultWater = $water.not('.reverse-water');
		var $reverseWater = $water.filter('.reverse-water');
		var timeScale = 2;
		tl
		  .from($slide.find('.water_wrap'), 0.5, { top: 288, opacity:0}, 1)
		  .to($defaultWater, 1.5, { left: '-' + ($defaultWater.width() / 3), ease: Linear.easeIn, repeat: -1 }, 0)
		  .to($reverseWater, 1.5, { right: '-' + ($defaultWater.width() / 3), ease: Linear.easeIn, repeat: -1 }, 0)
		  .from($water.filter('.low-water'), .6, { bottom: '-50%', opacity: 0 }, .2)
		  .from($water.filter('.high-water'), 1, { bottom: '-50%', opacity: 0 }, 2)
		  .to($slide.find('.time1 .digit'), 1.5, {top:-520, ease: Sine.easeIn}, 1)
		  .to($slide.find('.time2 .digit'), 2, {top:-2210, ease: Sine.easeIn}, 1)
		;
		
		/*for (var i = 0; i < 4; i++) {
	      tl.delay(4).to($slide.find('.time1 .digit'), .2, {top: -130*(i+1), delay: .8}, (i+1)/5);
		}
		for (var i = 0; i < 17; i++) {
	      tl.delay(4).to($slide.find('.time2 .digit'), .2, {top: -130*(i+1), delay: .8}, (i+1)/15);
		}*/

	});
	
	//预定义第六页动画
	$('.slide-6').each(function (i, elem) {
		var $slide = $(this);
		var tl = $slide.data().tl;
		
		tl
		  .from($slide.find('.glass'), 0.1, {opacity:0}, 0.5)
		  .from($slide.find('.glass'), 1, {top:-90}, 1)
		  .to($slide.find('.arrow'), 0.1, {opacity:1}, 1.5)
		  .to($slide.find('.arrow'), 1, {opacity:0,top:502}, 2)
		  .from($slide.find('.text'), 0.5, {opacity:0}, 1.8)
		  .to($slide.find('.text'), 1, {opacity:0}, 7.5)
		  .to($slide.find('.eye_wrap'), 0.5, {rotation:-10,transformOrigin: "center center"}, 3.5)
		  .to($slide.find('.eye_wrap'), 1, {rotation:10,transformOrigin: "center center"}, 4.5)
		  .to($slide.find('.eye_wrap'), 0.5, {rotation:0,transformOrigin: "center center"}, 5.5)
		;
	});
	
	//预定义第七页动画
	$('.slide-7').each(function (i, elem) {
		var $slide = $(this);
		var tl = $slide.data().tl;
		
		tl
		  .to($slide.find('.circle_wrap'), 0.5, {y: -5, yoyo: true, repeat: 5, ease: Sine.easeInOut}, 0)
		  .to($slide.find('.glass'), 0.5, {rotation:2,transformOrigin: "center center",scale:1.5}, 0.5)
		  .to($slide.find('.circle'), 1, {opacity:0,scale:0},1)
		  .to($slide.find('.glass'), 0.7, {left:200, top:170},1)
		  //.to($slide.find('.glass'), 0.5, {scaleY:1.4,scaleX:1.4,yoyo: true, repeat: 3,ease: Sine.easeInOut})
		  .to($slide.find('.glass'), 0.7, {scaleY:1.0,scaleX:1.4,yoyo: true, repeat: 3,ease: Sine.easeInOut},1.5)
		  .from($slide.find('.txt1'), 1, {opacity:0}, 2)
		  .from($slide.find('.txt2'), 1, {opacity:0}, 2.5)
		
	});
	
	
	//设置翻页
	var swiper = new Swiper('.swiper-container', {
		pagination: '.swiper-pagination',
		paginationClickable: true,
		direction: 'vertical',
		hashnav: false,
		onSlideChangeEnd: onSlideChangeEnd,
		onSlideChangeStart: slideChangeStart
	});	
	
	function slideChangeStart(swiper) {
	  $('#soundSp')[0].play();
	  if (swiper.activeIndex+1>1) {
	    //$('#soundBg')[0].pause();
	  }
	  else {
	    //$('#soundBg')[0].loop = true;
    	//$('#soundBg')[0].play();
	  }
	  return;
	}
	
	//翻页结束时触发事件
	function onSlideChangeEnd(swiper){
	  //当前页播放动画
	  var slide = swiper.slides[swiper.activeIndex];
      var t1 = $(slide).data().tl;
	  t1.play(0);
	  //前一页停在动画的开始
	  var prevSlide = swiper.slides[swiper.previousIndex];
	  prevTl = $(prevSlide).data().tl;
	  prevTl.pause(0);
	  
	  var tlBottom = new TimelineLite();
	  var bottomHL = $(slide).data('bottom-hl');
	  if (bottomHL) {
	    $('.bottom').find('.flex-1 span').removeClass('on');
	    $('.bottom').find('.icon'+bottomHL+' span').addClass('on');
		$('.bottom').show();
		tlBottom.fromTo('.bottom', .3, { bottom: -120,opacity: 0}, { bottom: 15,opacity: 1,ease: Sine.easeInOut});
	  }
      else {
	    tlBottom.fromTo('.bottom', .3, { bottom: 15,opacity: 1}, { bottom: -120,opacity: 0,ease: Sine.easeInOut});
	  }

	  
	};
	
  };
  
  //这里应该是load函数
  function progress1(){
    init();
	//load成功以后播放第一页的动画
    var swiper = $('.swiper-container').data('swiper');
	var slide = swiper.slides[swiper.activeIndex];
	
    var t1 = $(slide).data('tl');
	t1.play(); 
  };
  
  //progress();
  var _BASEURLPREX,_BASEURL;
  $.ajax({
       url: 'wx-share/getToken.php',
       type: 'GET',
       dataType: 'json',
       data: {"link":window.location.href},
       error: function () {
           //alert('request failed');
           return false;
       },
       success: function (response) {
    	   wx.config({
               debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
               appId: response.appId, // 必填，公众号的唯一标识
               timestamp: response.timestamp, // 必填，生成签名的时间戳
               nonceStr: response.nonceStr, // 必填，生成签名的随机串
               signature: response.signature,// 必填，签名，见附录1
               jsApiList: ['onMenuShareTimeline','onMenuShareAppMessage','onMenuShareQQ'] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
           });
           _BASEURL = response.url;
           _BASEURLPREX = response.urlPrefix;
           //alert('wx.config call');
           return false;
       }
   });
   
   $.ajax({
       url: 'wx-share/pv.php',
       type: 'GET',
       dataType: 'text',
       success: function (response) {
           return false;
       }
   });
   
   wx.ready(function(){
   //alert(_BASEURLPREX);
   //alert(_BASEURL);
   		//alert('wx-api ready');
       // config信息验证后会执行ready方法，所有接口调用都必须在config接口获得结果之后，config是一个客户端的异步操作，所以如果需要在页面加载时就调用相关接口，则须把相关接口放在ready函数中调用来确保正确执行。对于用户触发时才调用的接口，则可以直接调用，不需要放在ready函数中。
		wx.onMenuShareTimeline({
		    title: '新品上市！海昌O2BEST睛透氧硅水凝胶隐形眼镜，革命性高透氧。', // 分享标题
		    link: _BASEURL, // 分享链接
		    imgUrl: _BASEURLPREX + 'images/wx-share-new.jpg', // 分享图标
		    success: function () { 
		        // 用户确认分享后执行的回调函数
		    },
		    cancel: function () { 
		        // 用户取消分享后执行的回调函数
		        //alert(_BASEURLPREX + 'images/wx-share-new.jpg');
		    }
		});
       wx.onMenuShareAppMessage({
           title: '挑战隐形眼镜最高透氧量', // 分享标题
           desc: '新品上市！海昌O2BEST睛透氧硅水凝胶隐形眼镜，革命性高透氧。', // 分享描述
           link: _BASEURL, // 分享链接
           imgUrl: _BASEURLPREX + 'images/wx-share-new.jpg', // 分享图标
           type: '', // 分享类型,music、video或link，不填默认为link
           dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
           success: function () { 
               // 用户确认分享后执行的回调函数
           },
           cancel: function () { 
               // 用户取消分享后执行的回调函数
           }
       });
       wx.onMenuShareQQ({
    	    title: '挑战隐形眼镜最高透氧量', // 分享标题
    	    desc: '新品上市！海昌O2BEST睛透氧硅水凝胶隐形眼镜，革命性高透氧。', // 分享描述
    	    link: _BASEURL, // 分享链接
    	    imgUrl: _BASEURLPREX + 'images/wx-share-new.jpg', // 分享图标
    	    success: function () { 
    	       // 用户确认分享后执行的回调函数
    	    },
    	    cancel: function () { 
    	       // 用户取消分享后执行的回调函数
    	    }
    	});
   });
   
    
    wx.error(function(res){
        // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。
        //alert(res);
        //for (var a in res) {
        //alert(res[a]);
        //}
    });
});




// 屏幕尺寸监测
(function () {
	function checkScreen() {
		if (document.documentElement.clientHeight < document.documentElement.clientWidth) {
			var $msg = $('<div>为了达到最佳的体验效果，建议您使用竖屏浏览</div>').appendTo('body');
			$msg.css({
				position: 'fixed',
				top: 0,
				left: '50%',
				padding: '.5em',
				background: 'rgba(0,0,0,.8)',
				color: '#fbfcc5',
				zIndex: 1,
				whiteSpace: 'nowrap',
				opacity: 0,
				borderRadius: '.5em'
			});
			$msg.css({ marginLeft: -$msg.width() / 2 });
			$msg.animate({ opacity: 1 }, 500).delay(2000).animate({ opacity: 0 }, 500, function () {
				$msg.remove();
			})
		}
	}
	function scaleContent() {
		setTimeout(function() {
			//$('.scale-container').each(function(i, elem) {
			$('.scale_control').each(function(i, elem) {
				var $container = $(this);
				var t = parseFloat($container.css('top'));
				var b = parseFloat($container.css('bottom'));
				var h = parseFloat($container.height());
				var ph = $container.parent().height();
				//$container.children('.scale-content').each(function(i, elem) {
					//var hContent = $(this).height();
					console.debug('top:'+t);
					console.debug('bottom:'+b);
					console.debug('h:'+h);
					console.debug('ph:'+ph);
					var hContent = 960;//960-0.85
					if (h <= hContent) {
						//var scale = (ph-t-b) / hContent;
						var scale = (h*0.85)/960;
						scale = Math.max(0, scale);
						$(this).css({transform: 'scale('+scale+') '});
						$(this).css({'top':'-70px'});
					}
					else {
						$(this).css({transform: ''});
					}
					$(this).toggleClass('scale-enabled', h<=hContent);
				//});
			});
		});
	}
	// var $pageContent = $('.page-content');
	$(window).resize(function () {
		// $pageContent.height(window.document.documentElement);
		checkScreen();
		scaleContent();
	});
	checkScreen();
	scaleContent();
})();
</script>
</body>
</html>
